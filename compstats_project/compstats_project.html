<!DOCTYPE html>
<html lang="en"><head>
<script src="compstats_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="compstats_project_files/libs/quarto-html/tabby.min.js"></script>
<script src="compstats_project_files/libs/quarto-html/popper.min.js"></script>
<script src="compstats_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="compstats_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="compstats_project_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="compstats_project_files/libs/quarto-html/quarto-syntax-highlighting-1100dc645a9806080dc50effd6ccb0f7.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.27">

  <meta name="author" content="Jonathan Fitter (jfitter@wu.ac.at)">
  <meta name="author" content="Max Heinze (mheinze@wu.ac.at)">
  <meta name="dcterms.date" content="2025-05-27">
  <title>Hamiltonian Monte Carlo and the No-U-Turn-Sampler</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="compstats_project_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="compstats_project_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="compstats_project_files/libs/revealjs/dist/theme/quarto-db862c0f81f3e165903284d184b10bdf.css">
  <link href="compstats_project_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="compstats_project_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="compstats_project_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="compstats_project_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block title-slide center">
  <div class="title-slide-content">
    <h1 class="title">Hamiltonian Monte Carlo and the No-U-Turn-Sampler</h1>
        <p class="subtitle">Computational Statistics Project</p>
        
    <div class="quarto-title-authors">
            <div class="quarto-title-author">
        <div class="quarto-title-author-name">
          
          Jonathan Fitter (<a href="mailto:jonathan.fitter@wu.ac.at">jfitter@wu.ac.at</a>)
          
        </div>
              </div>
            <div class="quarto-title-author">
        <div class="quarto-title-author-name">
          
          Max Heinze (<a href="mailto:mheinze@wu.ac.at">mheinze@wu.ac.at</a>)
          
        </div>
              </div>
          </div>

        <br>
    <p class="quarto-title-affiliation" style="font-size:0.9em;">
      Department of Economics, Vienna University of Economics and Business (WU Vienna)
    </p>
    

        <p class="date">May 27, 2025</p>
      </div>
</section>

<section>
<section id="intro-and-recap" class="title-slide slide level1 center">
<h1></h1>
<div style="position:relative;width:1280px;height:720px;background-color:var(--primary-color);
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            text-align:center;top:-12px;">
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;">&nbsp;</p><span class="menu-title" style="display: none">Intro and Recap</span><h1 style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;color:#fff;margin:25px 0;font-weight:800;">Intro and Recap</h1><p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#hamiltonian-monte-carlo" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Hamiltonian Monte Carlo</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#the-no-u-turn-sampler-nuts" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">The No-U-Turn-Sampler (NUTS)</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;"><a href="#our-implementation" style="text-decoration:none;color:var(--primary-color-semilight, #ffffff) !important;font-weight:800;">Our Implementation</a></p></div>
</section>
<section id="markov-chain" class="slide level2">
<h2>Markov Chain</h2>
<div class="fragment">
<p>A <span class="col1"><strong>Markov chain</strong></span> is a stochastic process <span class="math inline">\(\{X_t\}\)</span> indexed by time <span class="math inline">\(t\geq 0\)</span>.</p>
<ul>
<li class="fragment">We call the <strong>set of all values</strong> that <span class="math inline">\(\{X_t\}\)</span> can assume the <span class="col1"><strong>state space</strong></span> of the Markov Chain.</li>
<li class="fragment"><span class="math inline">\(\{X-t\}\)</span> is called a Markov Chain if it fulfills the <span class="col1"><strong>Markov property</strong></span> that <span class="math display">\[
P(X_{t+1}=j\mid X_0=i_0,\dots,X_t=i_t)=P(X_{t+1}=j\mid X_t=i_t),
\]</span> i.e., that the conditional distribution of the next state depends only on the current state.</li>
</ul>
</div>
<div class="fragment">
<p><span class="col1"><strong>Markov Chain Monte Carlo (MCMC)</strong></span> methods make use of Markov chains to sample from a <strong>target distribution</strong>.</p>
</div>
</section>
<section id="markov-chain-1" class="slide level2">
<h2>Markov Chain</h2>
<div class="columns">
<div class="column fragment" style="width:40%;">
<div class="w100 centering">
<p><!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.1 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="129.724909pt" height="159.589868pt" viewbox="-68.679929 -68.679909 129.724909 159.589868">
<style type="text/css">
@font-face{font-family:cmr10;src:url(data:application/x-font-woff;base64,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) format('woff');}
@font-face{font-family:cmmi10;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAAS0AAoAAAAABVQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEQAAABghVx0/mNtYXAAAAE4AAAALAAAADQADACWZ2x5ZgAAAWQAAAHqAAACHPT/EztoZWFkAAADUAAAAC8AAAA2Ktb5dWhoZWEAAAOAAAAAHgAAACQGMgHdaG10eAAAA6AAAAAQAAAAEAtZAIJsb2NhAAADsAAAAAoAAAAKAWIAsG1heHAAAAO8AAAAGAAAACAACAA6bmFtZQAAA9QAAADUAAABPpkPdcdwb3N0AAAEqAAAAAwAAAAgAAMAAHjaY2BmusY4gYGVgYFpFtPZfyIM/SCa8Q3jGwZjRk4GIGBjgANGBiSQUlyWDpR0ZHBmZvgP5DNDpJHU/AcKAwDzAA1KeNpjYGBgYmBgYAZiESDJCKZZGBSANAsQgvjO//8DScf///8fAPMZAFK5Bp942jXQz2oTURQG8Pvdk7nTJJOZ6KQzlaZT0vyZtpKkdIaZtosojYk1xbQ2UIIEgoIWBAU1RhcusogLQVdCQVy4cecDuHHlqg/g1oW4Eh9BknhH6Lmbw8dd/L7DOCvMZvwn/8GqbJOxEEG4adlmxvICS1ShuiXXD2wrCKvIqSJj2YGtQ+ZR7NUQevQF90QmJVCzyvPQlMFoTkEqafoUV6ezdiprpggp5aSrQYuv1N7/yQ35cRpxYzKyDFpSQQQ+Z6iAZt9vjDOFNLihiyhOGAL5MxwxOcQuzyYk+FfmsHW2JaWmn3eFtOUczOtQHdjCgFBz4r/XjHBByc2XhErnO8kP3qe3i+6SYaDbu0ujzn4H/Hr65rPpu6yu7zgfT/sDjkp9vGwqj970hpxv7H1rxgD9kG9f4JRVwW/ttE6MRHt7f1evxaIGMNGgJ83CNQ7j0uQzPW8XD2n666JIMAbmzX5Tkn+PzCAdeXnRK/BLrjRHYNtBKM8bCZfhyAIyr8ANwuhZtmWHsg4lrpJIxBVwHB80Xm00F4WF2Msbq/3AL4tYXFWo3Fx7XH/xgajjt56OO2urYk+Hxs+mf3VpVo3S7QdAfavbX+iVh3c4VtYrvYUkwLWHu0UPdDp6PWj5RxQrFPUDnRNj/wAd0lr+AAB42mNgZGBgAGJmnsm18fw2XxmYWRhA4ElU1E0E/f8lMzfTXSCXg4EJJAoAEy4KiQB42mNgZGBgZvjPACQ5GFT+X2DmZgCKoAAWAEr3AxUAAAJ2AAADAAAkAwgAKwLbADMAAAAAAFQAsAEOAAB42mNgZGBgYGGwZGBmAAFGBjQAAAaSAEN42k2OsWrDMBRFj6ljqFvI1A4diqaMxkr6AYUMmbJmLCSRCC5ICrJjyBL6AfnovCga+oQeR+ddCQE1FwruVTBN/V4llZwePOGFt8yVLJW55oMZTxTls5hPvjOXvPKTecI7v5kr8X+Za764LoM7ngYb1ToYG/3euU63Gxv7Lnilm/YhVtbbuB2sUbuzMmPXjwenFs280SwJOI6cGLBE+dlajEns2cvM0aFp2STXyynIRIlrxP5PrCThU2qbXjOS2nGWbhgl00s/SFqxkLtz2foG4AAwu3jaY2BmwAsAAH0ABA==) format('woff');}
text.f0 {font-family:cmmi10;font-size:9.96264px}
text.f1 {font-family:cmr10;font-size:9.96264px}

</style>
<g id="page1">
<path d="M-24.293-31.406251C-24.293-38.28125-29.87109-43.8594-36.746093-43.8594C-43.625-43.8594-49.2031-38.28125-49.2031-31.406251C-49.2031-24.52734-43.625-18.9531-36.746093-18.9531C-29.87109-18.9531-24.293-24.52734-24.293-31.406251Z" stroke="#000" fill="none" stroke-width=".59776"></path>
<text class="f0" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 -3.736 3.4039)">A</text>
<path d="M60.7461-31.406251C60.7461-38.28125 55.1719-43.8594 48.293-43.8594S35.8398-38.28125 35.8398-31.406251C35.8398-24.52734 41.4141-18.9531 48.293-18.9531S60.7461-24.52734 60.7461-31.406251Z" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<text class="f0" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 81.0121 3.4039)">B</text>
<path d="M-24.293 53.6367C-24.293 46.7578-29.87109 41.1836-36.746093 41.1836C-43.625 41.1836-49.2031 46.7578-49.2031 53.6367C-49.2031 60.5117-43.625 66.0898-36.746093 66.0898C-29.87109 66.0898-24.293 60.5117-24.293 53.6367Z" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<text class="f0" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 -3.9166 88.4444)">C</text>
<path d="M-40.04687-43.7227C-45.37891-63.6133-28.11719-63.6133-32.26172-48.1484" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M-32.96874-45.507848L-30.562489-48.85941L-32.300769-48.007851L-33.378899-49.617224Z"></path>
<path d="M-32.96874-45.507848L-30.562489-48.85941L-32.300769-48.007851L-33.378899-49.617224Z" stroke="#000" fill="none" stroke-width=".597758" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 -6.3651 -30.8543)">0.5</text>
<path d="M-23.9961-31.406251H30.957" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M33.69141-31.406251L29.832033-32.86328L31.10547-31.406251L29.832033-29.94531Z"></path>
<path d="M33.69141-31.406251L29.832033-32.86328L31.10547-31.406251L29.832033-29.94531Z" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 36.155101 -3.6195)">0.3</text>
<path d="M-30.37109-20.3633C-18.0977 .8984-18.0977 21.332-28.08203 38.6211" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M-29.449226 40.992237L-26.253917 38.375048L-28.156256 38.750046L-28.781253 36.918019Z"></path>
<path d="M-29.449226 40.992237L-26.253917 38.375048L-28.156256 38.750046L-28.781253 36.918019Z" stroke="#000" fill="none" stroke-width=".597746" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 19.2016 45.7304)">0.2</text>
<path d="M44.9922-43.7227C39.6641-63.6133 56.9219-63.6133 52.7773-48.1484" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M52.070266-45.507839L54.480425-48.859404L52.738237-48.007842L51.660112-49.617217Z"></path>
<path d="M52.070266-45.507839L54.480425-48.859404L52.738237-48.007842L51.660112-49.617217Z" stroke="#000" fill="none" stroke-width=".597758" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 78.6753 -30.8543)">0.6</text>
<path d="M44.9922-19.0859C35.043 18.043 12.6992 40.3867-20.0039 49.1484" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M-22.644498 49.855516L-18.539033 50.265672L-20.148408 49.187549L-19.292937 47.44927Z"></path>
<path d="M-22.644498 49.855516L-18.539033 50.265672L-20.148408 49.187549L-19.292937 47.44927Z" stroke="#000" fill="none" stroke-width=".597758" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 60.8415 67.262)">0.4</text>
<path d="M-33.44922 65.9531C-28.11719 85.8438-45.37891 85.8438-41.23437 70.3788" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M-40.527356 67.738257L-42.93361 71.089819L-41.195322 70.234348L-40.117198 71.847624Z"></path>
<path d="M-40.527356 67.738257L-42.93361 71.089819L-41.195322 70.234348L-40.117198 71.847624Z" stroke="#000" fill="none" stroke-width=".597758" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 -6.3651 122.3152)">0.7</text>
<path d="M-43.125 42.5898C-55.3984 21.332-55.3984 .8984-45.41406-16.3906" stroke="#000" fill="none" stroke-width=".59776" stroke-miterlimit="10"></path>
<path d="M-44.046868-18.761718L-47.242175-16.144529L-45.339833-16.523438L-44.714838-14.687502Z"></path>
<path d="M-44.046868-18.761718L-47.242175-16.144529L-45.339833-16.523438L-44.714838-14.687502Z" stroke="#000" fill="none" stroke-width=".597746" stroke-miterlimit="10"></path>
<text class="f1" x="-36.748029" y="-31.405241" transform="matrix(1 0 0 1 -31.9319 45.7304)">0.3</text>
</g>
</svg></p>
</div>
</div><div class="column fragment" style="width:60%;">
<p>Markov chains are</p>
<ul>
<li class="fragment"><strong>irreducible</strong>, i.e.&nbsp;every state can eventually be reached from any state;</li>
<li class="fragment"><strong>aperiodic</strong>, i.e.&nbsp;reverting to a state is not only possible after a multiple of a certain number of steps;</li>
<li class="fragment"><strong>positive recurrent</strong>, i.e.&nbsp;for all states, the expected number of transitions to return to that state is finite.</li>
</ul>
<p><span class="fragment">For such Markov Chains, <span class="col1"><strong>transition probabilities</strong></span> converge to a unique stationary distribution on the state space.</span></p>
</div></div>
</section>
<section id="metropolis-hastings" class="slide level2">
<h2>Metropolis-Hastings</h2>
<div class="columns">
<div class="column fragment" style="width:40%;">
<div style="height:2em;"></div>
<div class="w100 centering">
<p><!--?xml version='1.0' encoding='UTF-8'?-->
<!-- This file was generated by dvisvgm 3.2.1 -->
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="177.449935pt" height="195.063706pt" viewbox="-68.680185 -68.679876 177.449935 195.063706">
<style type="text/css">
@font-face{font-family:cmr7;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAAMAAAoAAAAAA3gAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEMAAABghVh1TGNtYXAAAAE4AAAAKQAAADQADACQZ2x5ZgAAAWQAAABKAAAAWEfGOV9oZWFkAAABsAAAACwAAAA2KwL4PGhoZWEAAAHcAAAAHgAAACQGgwLPaG10eAAAAfwAAAAIAAAACAZVAElsb2NhAAACBAAAAAYAAAAGACwAAG1heHAAAAIMAAAAFgAAACAABQAZbmFtZQAAAiQAAADKAAABMu0Ikexwb3N0AAAC8AAAABAAAAAgAAMAAXjaY2Bm1mKcwMDKwMA0i+nsPxGGfhDN+IbxDYMxIycDELAxwAEjAxJIKS5LB0raMtgyM/wH8pkh0khq/gOFAbO4DJUAeNpjYGBgYmBgYAZiESDJCKZZGBSANAsQgvi2//9DyP9HwHwGAFJDBpkAAAB42mNgYvBkKGO2YOxm4GYQZ2BgVGRTMzETVzQTE2FjR2IzC/2N5ZWU5GFaygMk/0YDSV6mxUARxghGDhUORhDxAM5iYAAABiwLngAAeNpjYGRgYADigyLy2fH8Nl8ZmFkYQOBJVNQtZJrZgrEbSHEwMIF4AAESCL142mNgZGBgZvjPACSbGDwZvJgtGIAiKIAJADyhAloAAALTAAADggBJAAAAAAAsAAB42mNgZGBgYGKQAGIQYGRAAwADDAAfAAB42j2MMQvCMBCFv2IVrYOD4OAgwR9QrAoubg5Org5u1gTp0FTSWnQRf7rXELyQ47v33h2Q8CGiq4iJ713F8iaB+4yZBh6IvgicMGdJjygeibJgHzhmyCVwnxl54IHor8AJW76Hqnw8G+PUqdLG2Vvpdmfj6qKyKktX3Xg01rhrY7TK30q3Rd3eS7VJ12nGgYqSB08aDA7FSRTt2XITz7Hj7OeaQjwrmYyU1d89imt94uqvaEnkvKVrWtmppd8lq9jI3lp+9gNYuC5LAAB42mNgZkAGjAxoAAAAjgAF) format('woff');}
@font-face{font-family:cmsy7;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAAMEAAoAAAAAA2QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEsAAABgaEBi/2NtYXAAAAFAAAAAKgAAADQADOCJZ2x5ZgAAAWwAAABAAAAAQKOSPRloZWFkAAABrAAAAC8AAAA2K1z4smhoZWEAAAHcAAAAHgAAACQGtPziaG10eAAAAfwAAAAIAAAACAORAK1sb2NhAAACBAAAAAYAAAAGACAAAG1heHAAAAIMAAAAFwAAACAABAAPbmFtZQAAAiQAAADQAAABOBOBKrlwb3N0AAAC9AAAABAAAAAgAAMAAXjaY2Bmnsg4gYGVgYFpFtPZfyIM/SCa8Q3jGwZjRk4GIGBjQAABJHZKcVk6A9sDswdmzIp/jBgYmBWZzwGFGREq/v9nYAAAKvEP/gB42mNgYGBiYGBgBmIRIMkIplkYFIA0CxAC+Q/M/v+HkPKnwfIMAGTwB3IAAAABAK3/JgLkAtsADQAACQEGByYnJjcBNjcWFxYC2/4GBhMZAQEJAfoHExgBAQKt/IwRAgMWBg8DdBECAxYGAAB42mNgZGBgAOLfzqFf4/ltvjIwszCAwJOoqFsI+r8a80Sm20AuBwMTSBQATmILtQB42mNgZGBgVvxjBCQnMqz9K8P0hAEoggKYAG8LBJcAAAORAAAAAACtAAAAAAAgAAB42mNgZGBgYGLgYwDRDFASCQAAAfsAFAB42k2MPU/DMBRFT0RSiTCwIAYG8MAcNS1SN5YOnbp2YmlrU2WIU8VppEiIkd/NrfHAk/x07sczUPJNxnUy7uO+Tk4h9ccFdzwknkm9JC554pUbsvxWzjPviXMlH4kLHvlMPJP/lbjkjZ91154vg+vNtrOu98c2TKud60PTeVNX86g3zrt+PzhrDpOxYxPGU2uW1aKqWdPRcubCgKPHsJVjI3uOygITK3bRCTRKvVo1FfN/+Ua5j519/Mmqc1BiRKOugvZJbcNSlwu9+hfzhTBPeNpjYGZABowMaAAAAI4ABQ==) format('woff');}
@font-face{font-family:cmmi7;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAATUAAoAAAAABewAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEMAAABghYN0r2NtYXAAAAE4AAAAMgAAADwAgADEZ2x5ZgAAAWwAAAIIAAACtBTwbMpoZWFkAAADdAAAAC8AAAA2KpH5bmhoZWEAAAOkAAAAHwAAACQFrQH0aG10eAAAA8QAAAAQAAAAEAl+AMpsb2NhAAAD1AAAAAoAAAAKAc4A1G1heHAAAAPgAAAAGAAAACAABwBYbmFtZQAAA/gAAADPAAABOPNhKqFwb3N0AAAEyAAAAAwAAAAgAAMAAHjaY2BmimecwMDKwMA0i+nsPxGGfhDN+IbxDYMxIycDELAxwAEjAxJIKS5LB0pmMGQzM/wH8pkh0khq/gOFAdEGDSIAeNpjYGBgYmBgYAZiESDJCKZZGDSANBuQZgTKZjJk//8P5GeA6P8z/88AqwICAJmpCT4AAHjabZFLbtNQFIZ9jl+xHfv6lXsdEqVx7FwHUrl52k2TpiRpOygtLwnECsoikBALYMAmQOykY9bBvDMo10JIIKoz+8/k//5PAunq7hbf4Y30RJJAXkPZQV0joOkONDQ2Kcpiyjqga+J6PJudgEjKgmeOyIjiQJLDvAzWwBPxXsO0LKgOm6ftl4vzWR0wxKBum3J7b+WjZ2rALC9ZDw5Bth1KEelg9TwiatA1aiYzfE/9pCBJDRfA0U/3+4Bff97EU1APZna+0patOPZ6eHLsI7IRo7ly8LBuddPtbtwYI+4G1Lp4z1vEgsCmeGoTUzFJTVfkuoTS6O4WrvGLZEorQSrqi+JrmFBZIM1nek8QJpkgrPDKDjCNYDXCvxPkkBVwCXEUNiAZht8eP9CanVUInqVBVKEN5wBqs+kTVzAvA/QMDajlJ8figfiBxgCM0Lj54/vnbehm8nLrIhrOmDZyFSap5242g0fdM/iLEcb9SPrt6Ux4el15KsqqekPMzzNelFwUrZxRVl1I5JAyoVLoqII/8nhZZAKACPgev0fa9d6b7MUrDinlMrCuEw6fZZxF3RkhIwVlFUjIh6asm4IJXDNsL7IdgioDXBwmRGH8Pn1vncv+fF+Iw9RJaw7AEY9DUUE16MI07FZA90C5SomJaKp5q50r08LxHW2QqR+P/Og/kZL0C+DjU/142mNgZGBgAGLBIwX74/ltvjIwszCAwJOoqFsI+v83pmNMx4FcDgYmkCgARIwMIQB42mNgZGBgZvjPwMDAdIzBgEGTqZoBKIICWABDHgKnAALGAAACrABNAZ4AMAJuAE0AAAAAAHQA1AFaAAB42mNgZGBgYGEIZ2BiAAFGBjQAAAlpAGB42k2MPW/CMBCGn4gEiTCwoA4MxUPniAASWxcGJlYmFsAuymAbOSESUtWxv7uH8dCTfHrejzNQ8kPGczImcT8npxD14oIx08RDUfPEJTM+GJDlI3He+UycS3JMXPDGV+Kh+N+JS9b8br293TsT1N5rE9zF2mZzMKFtvFN1tYh6Z5wJp85odX4o3Tdtf7VqVS2rmi0ey407HYaAYi+Ojuy4SGZp2HCITivsxVfUVCz+5TvJXeyc4k9aOmcesjW9NFrZV+kqVnK5lFf/AcutL/cAeNpjYGbACwAAfQAE) format('woff');}
@font-face{font-family:cmex10;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAANEAAoAAAAAA6QAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEsAAABgcFlae2NtYXAAAAFAAAAAKgAAADQADOCjZ2x5ZgAAAWwAAAB4AAAAeNI9zIJoZWFkAAAB5AAAAC4AAAA2K8ryr2hoZWEAAAIUAAAAHwAAACQHT/idaG10eAAAAjQAAAAIAAAACAYNADhsb2NhAAACPAAAAAYAAAAGADwAAG1heHAAAAJEAAAAFwAAACAABAAjbmFtZQAAAlwAAADVAAABPqAldcZwb3N0AAADNAAAABAAAAAgAAMAAXjaY2BmZmOcwMDKwMA0i+nsPxGGfhDN+IbxDYMxIycDELAxIIAAEjuluCydge1BwIMAZvEvmgwMzOLc14HCjAgV//8zMAAA/DUPkwB42mNgYGBiYGBgBmIRIMkIplkYFIA0CxAC+Q8C/v+HkPIbwfIMAGcSB4wAAAABADj7/QP/AAEAIQAACQEmNhchFyMmJyYnJgchARYUBwEhPgE3PgE3MwchBjUmNwGv/ooBCxMDUVgaK1o8QmBF/msBTQgK/pwBtG9zC0NfExpY/K8cAQv93QICFwsB8GkqHgoOAv43CwcM/kgBGAUXWDr/Aw4DDnjaY2BkYGAA4lz9o4nx/DZfGZhZGEDgSVTULQT9+y/zf5AqBg4GJpAoADQ3C1QAAHjaY2BkYGAW/6LJwMBiwWDBYMn8nwEoggKYAEd+AusAAdUAAAQ4ADgAAAAAADwAAHjaY2BkYGBgYlBiANEMUBIJAAAD7wAoAHjaTY6xasMwEIY/U8dQt9CpHTIUTRmNlfQBChkyZc0YSKIjuGA5yI5JltIH6EP3omjoCf18+u+/Q0DJNxm3yniJequcQl93nvDEa+JCj0lcMmXGA1n+qM47n4lzntkmnvDGV+JC/Z/EJR/8Lrv2dB4kmHXnJPhDKxdbbyT0TeeNreq7sRIvYTeIM/urcWPTj8fWLKp5ZVnS0XLizIAQ9GdrdVxkz0F7wgVLzSZ6PY32veYslbr/EyslH1O7uM1pas9V1THqXK961LxhobNzvfYP7Okw1wAAAHjaY2BmQAaMDGgAAACOAAU=) format('woff');}
@font-face{font-family:cmsy10;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAANAAAoAAAAAA6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEoAAABgiMiTq2NtYXAAAAFAAAAAMQAAADxDud9DZ2x5ZgAAAXQAAABlAAAAaBRNI5NoZWFkAAAB3AAAAC8AAAA2Kuf4sWhoZWEAAAIMAAAAHgAAACQGN/9JaG10eAAAAiwAAAAMAAAADAb+AM9sb2NhAAACOAAAAAgAAAAIABoANG1heHAAAAJAAAAAFwAAACAABQANbmFtZQAAAlgAAADVAAABPq81deNwb3N0AAADMAAAABAAAAAgAAMAAXjaY2BmKmScwMDKwMA0i+nsPxGGfhDN+IbxDYMxIycDELAxwAEjEDvAOCnFZelAyRolIWapP5oMDMxSzNehaqDg/38GBgD4Uw6EAAB42mNgYGBiYGBgBmIRIMkIplkYNIA0G5BmBMrWKAn9/w/kg+n/rXc/gFUBAQCV2gkZAAAAeNpjYGSo/M/IsITpPwM3A4OwoBibkpq5oJqZkdhiRnZZdkYQwXT7jxefmBgf8zYgyQAEjAxhDK+YjjGKgfSoKrKpmZiJK5qJibAxLf57jVdMjJdJC0i+YeKQ4WACEUAtALwSEQsAAAB42mNgZGBgAGJRvp6D8fw2XxmYWRhA4ElU1C0E/Z+RWYbpP5DLwcAEEgUAFeUKJwB42mNgZGBglvqjCSRlGMIYGJiOMQBFUAAzAD+sAoUAAAMcAAABHAB5AsYAVgAAAAAAGgA0eNpjYGRgYGBm4GEA0QxQEgkAAAHkABMAeNpNjrFqwzAURY+pY6gbyNQOHYqmjMZK8gGFDJmyZiwkkQguWA6SY/AS+gH56LwoGvqEHkf33vcQUHIl41EZs9gflVPI68kT3nhPXMhRiUs+mfNClr+K8sV34pwpP4knfPCbuBD9L3HJitu6a8+X3nq17Yz17tiGUdc760PTOaWr+ilsrLN+31ujDqMyQxOGU6uW1aLSrOloOXOhx+LlZ1tRTGTHUbzAiKZmF7VAI76TnKYS9X9iIwkXU/u4zUjqIJ4SGmQuSD9JXrGU2YVcfQcJXTETAAAAeNpjYGZABowMaAAAAI4ABQ==) format('woff');}
@font-face{font-family:cmr10;src:url(data:application/x-font-woff;base64,d09GRgABAAAAAAPAAAoAAAAABDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAAA9AAAAEQAAABghUNz/GNtYXAAAAE4AAAAMgAAADwATAB+Z2x5ZgAAAWwAAADyAAABANGpSQJoZWFkAAACYAAAAC0AAAA2Kkv4sWhoZWEAAAKQAAAAHwAAACQE6AG+aG10eAAAArAAAAAQAAAAEAeaAPhsb2NhAAACwAAAAAoAAAAKAKwAVm1heHAAAALMAAAAFwAAACAABgAabmFtZQAAAuQAAADOAAABOILjKqdwb3N0AAADtAAAAAwAAAAgAAMAAHjaY2BmfMY4gYGVgYFpFtPZfyIM/SCa8Q3jGwZjRk4GIGBjgANGBiSQUlyWDpTUYDBkZvgP5DNDpJHU/AcKAwDzYQ0ueNpjYGBgYmBgYAZiESDJCKZZGDSANBuQZgTKajIY/v8P5GuA6P83/18CqwICAItXCMQAAHjaY2BkSPnPwBjCzMAgzsDAKqKkpq7HaK5mZm7HaMTPyMcoziYkzyjGGCyWbKgpw8goo2aYJsbIE+fByOQSz8/8jSspPmKVrdPC0ORUHoHEP+2V//6lCLIwAAEjgyXQXE2IuYxibOx8jEqmQFPVTdT0GdXMzYzExOUYGTXAJoryxnoxBfsIMTMyioLtYYCamPS3deEHXyEWJrA9QDOjgWatZVrNIAGkBdnErBlF1ZXZTY2NzNQF+RjVTcXMzM3EGHWZFZwUA1cFKjrLM2v6CMrkGAuyM/X/PSQjqsDMrCAqwyQkzMEozySqz8jFAAAETS2kAAB42mNgZGBgAOKmqFPX4/ltvjIwszCAwJOoqFsI+j8DUwMziMvBwASiAD8/CpgAAAB42mNgZGBgZvjPwMDA1MBgyWDJuJYBKIICWABCCQKrAAKAAAABjQBkAY0AOQIAAFsAAAAAACwAVgCAAAB42mNgZGBgYGGQZADRDFASCQAAA0QAIQB42kWMPU/DMBRFT0RaiTCwIAYG8MAcxS0zS4dOXTuxtLWpMsSpnDRSJcTI7+bWWOJJfjr34xmo+KbgOgX3aV+nZCb1xzPueMg8l3rJXPHEKzcU5a2cZ94zl0o+Ms945DPzXP5X5oo3flZ9dzqPPppN73wMhy7aZuvj0PbB2LpJeu2Dj7vRO7O/GDe1w3TszLJe1JYVPR0nzox4IoaNHJc4cFAWsTRskzPQKg1qWWq5//laeUidXfrJqbPnou2YdDVoH9U2LHW50LO/Y0kvDwAAeNpjYGbACwAAfQAE) format('woff');}
@font-face{font-family:cmmi10;src:url(data:application/x-font-woff;base64,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) format('woff');}
text.f0 {font-family:cmsy10;font-size:9.96264px}
text.f1 {font-family:cmsy7;font-size:6.973848px}
text.f2 {font-family:cmmi10;font-size:9.96264px}
text.f3 {font-family:cmmi7;font-size:6.973848px}
text.f4 {font-family:cmr10;font-size:9.96264px}
text.f5 {font-family:cmr7;font-size:6.973848px}
text.f6 {font-family:cmex10;font-size:9.96264px}

</style>
<g id="page1">
<path d="M-1.7734-26.320313C-1.7734-33.19922-7.34766-38.7734-14.226563-38.7734C-21.10547-38.7734-26.6797-33.19922-26.6797-26.320313C-26.6797-19.44141-21.10547-13.8672-14.226563-13.8672C-7.34766-13.8672-1.7734-19.44141-1.7734-26.320313Z" stroke="#000" fill="none" stroke-width=".3985"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 -1.7161 3.2853)">i</text>
<path d="M108.5705-26.320313C108.5705-33.19922 102.9965-38.7734 96.1175-38.7734C89.2425-38.7734 83.6641-33.19922 83.6641-26.320313C83.6641-19.44141 89.2425-13.8672 96.1175-13.8672C102.9965-13.8672 108.5705-19.44141 108.5705-26.320313Z" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 108.0094 2.3167)">j</text>
<path d="M-1.7734 84.023C-1.7734 77.148-7.34766 71.5703-14.226563 71.5703C-21.10547 71.5703-26.6797 77.148-26.6797 84.023C-26.6797 90.902-21.10547 96.477-14.226563 96.477C-7.34766 96.477-1.7734 90.902-1.7734 84.023Z" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 -2.7501 113.8052)">k</text>
<path d="M-3.2695-32.64844C26.5938-49.8906 55.2969-49.8906 83.4336-33.64453" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<path d="M84.124964-33.246099C83.363246-33.914062 82.699184-34.757812 82.01168-35.960938C82.597621-34.585937 82.199177-33.894535 80.718719-33.718753C82.101529-33.72266 83.16403-33.570314 84.124964-33.246099Z"></path>
<path d="M84.124964-33.246099C83.363246-33.914062 82.699184-34.757812 82.01168-35.960938C82.597621-34.585937 82.199177-33.894535 80.718719-33.718753C82.101529-33.72266 83.16403-33.570314 84.124964-33.246099Z" stroke="#000" fill="none" stroke-width=".398491" stroke-miterlimit="10" stroke-linejoin="bevel"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">g</text>
<text class="f4" x="-9.118177" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">(</text>
<text class="f2" x="-5.243804" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">j</text>
<text class="f0" x="2.196509" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">|</text>
<text class="f2" x="7.73125" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">i</text>
<text class="f4" x="11.163509" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">)</text>
<text class="f2" x="16.698282" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">α</text>
<text class="f4" x="23.108281" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">(</text>
<text class="f2" x="26.982654" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">i,<tspan x="34.842721">j</tspan></text>
<text class="f4" x="39.515701" y="-26.321035" transform="matrix(1 0 0 1 26.3638 -25.2687)">)</text>
<path d="M-17.5-38.543C-22.78906-58.2773-5.66406-58.2773-10.4375-40.4688" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<path d="M-10.644552-39.699178C-10.195333-40.609337-9.5508-41.468714-8.566427-42.441368C-9.742209-41.519489-10.511741-41.72652-11.070332-43.113245C-10.707053-41.777304-10.578146-40.710896-10.644552-39.699178Z"></path>
<path d="M-10.644552-39.699178C-10.195333-40.609337-9.5508-41.468714-8.566427-42.441368C-9.742209-41.519489-10.511741-41.72652-11.070332-43.113245C-10.707053-41.777304-10.578146-40.710896-10.644552-39.699178Z" stroke="#000" fill="none" stroke-width=".398498" stroke-miterlimit="10" stroke-linejoin="bevel"></path>
<text class="f4" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">1</text>
<text class="f0" x="-7.03228" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">−</text>
<text class="f6" x="2.930334" y="-33.793076" transform="matrix(1 0 0 1 -51.5922 -34.8868)"></text>
<text class="f3" x="13.446486" y="-23.332197" transform="matrix(1 0 0 1 -51.5922 -34.8868)">h</text>
<text class="f1" x="18.110744" y="-23.332197" transform="matrix(1 0 0 1 -51.5922 -34.8868)"></text>
<text class="f5" x="18.110744" y="-23.332197" transform="matrix(1 0 0 1 -51.5922 -34.8868)">=</text>
<text class="f3" x="24.226728" y="-23.332197" transform="matrix(1 0 0 1 -51.5922 -34.8868)">i</text>
<text class="f2" x="29.203969" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">g</text>
<text class="f4" x="34.313277" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">(</text>
<text class="f2" x="38.187651" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">h</text>
<text class="f0" x="46.695053" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">|</text>
<text class="f2" x="52.229794" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">i</text>
<text class="f4" x="55.662052" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">)</text>
<text class="f2" x="61.196825" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">α</text>
<text class="f4" x="67.606824" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">(</text>
<text class="f2" x="71.481198" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">i,<tspan x="79.341264">h</tspan></text>
<text class="f4" x="85.081334" y="-26.321035" transform="matrix(1 0 0 1 -51.5922 -34.8868)">)</text>
<path d="M85.1602-19.99609C55.2969-2.7539 26.5938-2.7539-1.543-19" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<path d="M-2.234375-19.398437C-1.472657-18.726562-.80859-17.88281-.121094-16.67969C-.707028-18.054685-.308591-18.746092 1.171874-18.925786C-.210933-18.917965-1.273438-19.070313-2.234375-19.398437Z"></path>
<path d="M-2.234375-19.398437C-1.472657-18.726562-.80859-17.88281-.121094-16.67969C-.707028-18.054685-.308591-18.746092 1.171874-18.925786C-.210933-18.917965-1.273438-19.070313-2.234375-19.398437Z" stroke="#000" fill="none" stroke-width=".398491" stroke-miterlimit="10" stroke-linejoin="bevel"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">g</text>
<text class="f4" x="-9.118177" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">(</text>
<text class="f2" x="-5.243804" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">i</text>
<text class="f0" x=".955787" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">|</text>
<text class="f2" x="6.490528" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">j</text>
<text class="f4" x="11.163509" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">)</text>
<text class="f2" x="16.698282" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">α</text>
<text class="f4" x="23.108281" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">(</text>
<text class="f2" x="26.982654" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">j<tspan x="31.102153">,</tspan><tspan x="35.529961">i</tspan></text>
<text class="f4" x="38.96222" y="-26.321035" transform="matrix(1 0 0 1 26.6406 30.25009)">)</text>
<path d="M92.8435-14.0977C79.25 36.6328 48.7227 67.1562-.082 80.234" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<path d="M-.851564 80.441426C.164063 80.375024 1.226561 80.503927 2.562501 80.867205C1.175785 80.308612 .968746 79.539085 1.89453 78.363309C.917972 79.34768 .058595 79.992209-.851564 80.441426Z"></path>
<path d="M-.851564 80.441426C.164063 80.375024 1.226561 80.503927 2.562501 80.867205C1.175785 80.308612 .968746 79.539085 1.89453 78.363309C.917972 79.34768 .058595 79.992209-.851564 80.441426Z" stroke="#000" fill="none" stroke-width=".398498" stroke-miterlimit="10" stroke-linejoin="bevel"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">g</text>
<text class="f4" x="-9.118177" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">(</text>
<text class="f2" x="-5.243804" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">k</text>
<text class="f0" x="3.023749" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">|</text>
<text class="f2" x="8.558489" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">j</text>
<text class="f4" x="13.23147" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">)</text>
<text class="f2" x="18.766243" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">α</text>
<text class="f4" x="25.176242" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">(</text>
<text class="f2" x="29.050616" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">j<tspan x="33.170114">,</tspan><tspan x="37.597922">k</tspan></text>
<text class="f4" x="43.098142" y="-26.321035" transform="matrix(1 0 0 1 42.9726 67.5625)">)</text>
<path d="M-20.55469 73.0664C-37.7969 43.2031-37.7969 14.5-21.55078-13.6367" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<path d="M-21.152344-14.328094C-21.820314-13.566377-22.664065-12.902311-23.867186-12.214816C-22.49219-12.800749-21.800783-12.402313-21.624999-10.917939C-21.628908-12.304653-21.476563-13.367157-21.152344-14.328094Z"></path>
<path d="M-21.152344-14.328094C-21.820314-13.566377-22.664065-12.902311-23.867186-12.214816C-22.49219-12.800749-21.800783-12.402313-21.624999-10.917939C-21.628908-12.304653-21.476563-13.367157-21.152344-14.328094Z" stroke="#000" fill="none" stroke-width=".398491" stroke-miterlimit="10" stroke-linejoin="bevel"></path>
<text class="f2" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">g</text>
<text class="f4" x="-9.118177" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">(</text>
<text class="f2" x="-5.243804" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">i</text>
<text class="f0" x=".955787" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">|</text>
<text class="f2" x="6.490528" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">k</text>
<text class="f4" x="11.990748" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">)</text>
<text class="f2" x="17.525521" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">α</text>
<text class="f4" x="23.93552" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">(</text>
<text class="f2" x="27.809894" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">k<tspan x="33.310113">,</tspan><tspan x="37.737921">i</tspan></text>
<text class="f4" x="41.17018" y="-26.321035" transform="matrix(1 0 0 1 -48.8946 66.1648)">)</text>
<path d="M-10.95313 96.246C-5.66406 115.98-22.78906 115.98-18.01563 98.172" stroke="#000" fill="none" stroke-width=".3985" stroke-miterlimit="10"></path>
<path d="M-17.81248 97.402384C-18.261699 98.312548-18.902322 99.171923-19.886695 100.144577C-18.710917 99.222707-17.941387 99.429737-17.386705 100.816461C-17.749979 99.480512-17.874978 98.414104-17.81248 97.402384Z"></path>
<path d="M-17.81248 97.402384C-18.261699 98.312548-18.902322 99.171923-19.886695 100.144577C-18.710917 99.222707-17.941387 99.429737-17.386705 100.816461C-17.749979 99.480512-17.874978 98.414104-17.81248 97.402384Z" stroke="#000" fill="none" stroke-width=".398498" stroke-miterlimit="10" stroke-linejoin="bevel"></path>
<text class="f4" x="-14.227485" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">1</text>
<text class="f0" x="-7.03228" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">−</text>
<text class="f6" x="2.930334" y="-33.793076" transform="matrix(1 0 0 1 -54.4527 148.36)"></text>
<text class="f3" x="13.446486" y="-23.332197" transform="matrix(1 0 0 1 -54.4527 148.36)">h</text>
<text class="f1" x="18.110744" y="-23.332197" transform="matrix(1 0 0 1 -54.4527 148.36)"></text>
<text class="f5" x="18.110744" y="-23.332197" transform="matrix(1 0 0 1 -54.4527 148.36)">=</text>
<text class="f3" x="24.226728" y="-23.332197" transform="matrix(1 0 0 1 -54.4527 148.36)">k</text>
<text class="f2" x="30.788907" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">g</text>
<text class="f4" x="35.898215" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">(</text>
<text class="f2" x="39.772589" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">h</text>
<text class="f0" x="48.279991" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">|</text>
<text class="f2" x="53.814731" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">k</text>
<text class="f4" x="59.314951" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">)</text>
<text class="f2" x="64.849724" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">α</text>
<text class="f4" x="71.259723" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">(</text>
<text class="f2" x="75.134097" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">k<tspan x="80.634316">,</tspan><tspan x="85.062124">h</tspan></text>
<text class="f4" x="90.802194" y="-26.321035" transform="matrix(1 0 0 1 -54.4527 148.36)">)</text>
</g>
</svg></p>
</div>
</div><div class="column fragment" style="width:60%;">
<p><strong>Metropolis-Hastings</strong> is a class of MCMC methods.</p>
<ul>
<li class="fragment">Propose <span class="math inline">\(Y\sim g(\cdot\mid X_t)\)</span>, compute <span class="math inline">\(\alpha(i,j)=\min\Bigl(1,\frac{f(j)\,g(i\mid j)}{f(i)\,g(j\mid i)}\Bigr)\)</span>.</li>
<li class="fragment">If <span class="math inline">\(U\le\alpha(i,j)\)</span>, move <span class="math inline">\(i\to j\)</span>; else stay at <span class="math inline">\(i\)</span>.</li>
<li class="fragment">Chain is reversible and has <span class="math inline">\(f\)</span> as its stationary distribution.</li>
</ul>
</div></div>
</section></section>
<section>
<section id="hamiltonian-monte-carlo" class="title-slide slide level1 center">
<h1></h1>
<div style="position:relative;width:1280px;height:720px;background-color:var(--primary-color);
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            text-align:center;top:-12px;">
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#intro-and-recap" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Intro and Recap</a></p><span class="menu-title" style="display: none">Hamiltonian Monte Carlo</span><h1 style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;color:#fff;margin:25px 0;font-weight:800;">Hamiltonian Monte Carlo</h1><p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#the-no-u-turn-sampler-nuts" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">The No-U-Turn-Sampler (NUTS)</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#our-implementation" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Our Implementation</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;">&nbsp;</p></div>
</section>
<section id="origins-in-physics" class="slide level2">
<h2>Origins in Physics</h2>
<div class="columns">
<div class="column fragment centering" style="width:45%;">
<div style="height:3em;"></div>
<p><img data-src="figures/puck.svg" style="width:100.0%"></p>
</div><div class="column fragment" style="width:55%;">
<p>Imagine a <strong>frictionless puck</strong> on a <strong>non-even surface</strong>. The <span class="col1"><strong>state of this system</strong></span> is given by</p>
<ul>
<li class="fragment"><span class="math inline">\(\boldsymbol{q}\)</span>, the <span class="col1"><strong>position</strong></span> of the puck;</li>
<li class="fragment"><span class="math inline">\(\boldsymbol{p}\)</span>, the <span class="col4"><strong>momentum</strong></span> of the puck, given by <span class="math inline">\(\mathrm{mass}\times\mathrm{velocity}\)</span>.</li>
<li class="fragment">If the puck encounters a <strong>rising slope</strong>, momentum will decrease; if it encounters a <strong>falling slope</strong>, momentum will increase.</li>
<li class="fragment">The higher the surface at a position, the higher the puck’s <strong>potential energy</strong>, and the lower its <strong>kinetic energy</strong>.</li>
</ul>
</div></div>
<!---

## Origins in Physics

:::{.incremental}
* We simulate the path of the puck starting from a position in this Hamiltonian system with a given kinetic energy
* Pre-determined step-size and number of steps (use of discretizer)
* After stopping at the final position along the path, we randomly introduce a new level of kinetic energy
* we simulate the path,...
:::

-->
</section>
<section id="from-physics-to-statistics" class="slide level2">
<h2>From Physics to Statistics</h2>
<div class="fragment">
<div style="height:1em;"></div>
<p>In <strong>non-physical</strong> applications,</p>
<div style="height:1.5em;"></div>
<div class="spacey">
<ul>
<li class="fragment">the <span class="col1"><strong>position</strong></span> <span class="math inline">\(\boldsymbol{q}\)</span> corresponds to the <span class="col1"><strong>variables of interest</strong></span>,</li>
<li class="fragment">the <span class="col2"><strong>potential energy</strong></span> <span class="math inline">\(\boldsymbol{p}\)</span> corresponds to the <span class="col2"><strong>negative log of the probability density</strong></span> for these variables, and</li>
<li class="fragment">the <span class="col4"><strong>momentum</strong></span> is an auxiliary variable that facilitates exploration of the target distribution space.</li>
</ul>
</div>
</div>
</section>
<section id="hamiltonian-dynamics" class="slide level2">
<h2>Hamiltonian Dynamics</h2>
<div class="fragment">
<p>The system is described by a so-called <span class="col1"><strong>Hamiltonian equation</strong></span>, <span class="math inline">\(H(q_p)\)</span>. Its partial derivatives, the <strong>equations of motion</strong>, determine how <span class="math inline">\(\boldsymbol{q}\)</span> and <span class="math inline">\(\boldsymbol{p}\)</span> change over time:</p>
</div>
<div class="fragment">
<div style="height:1.5em;"></div>
<p><span class="math display">\[
\begin{aligned}
\frac{\mathrm{d}q_i}{\mathrm{d}t}&amp;=\frac{\partial H}{\partial p_i},\\
\frac{\mathrm{d}p_i}{\mathrm{d}t}&amp;=-\frac{\partial H}{\partial q_i},\\
\end{aligned}
\]</span></p>
<div style="height:1.5em;"></div>
<p>for <span class="math inline">\(i = 1, \dots, d\)</span>, and <span class="math inline">\(d\)</span> being the length of the vectors <span class="math inline">\(\boldsymbol{q}\)</span> and <span class="math inline">\(\boldsymbol{p}\)</span>.</p>
</div>
</section>
<section id="potential-and-kinetic-energy" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Potential and Kinetic Energy</h2>
<div class="fragment">
<p>For <strong>Hamiltonian Monte Carlo</strong>, we usually use the following kind of Hamiltonian functions:</p>
<p><span class="math display">\[
H(\boldsymbol{q},\boldsymbol{p}) = \textcolor{var(--secondary-color)}{U(\boldsymbol{q})} + \textcolor{var(--tertiary-color)}{K(\boldsymbol{p})},
\]</span></p>
</div>
<div class="fragment">
<p>where the <span class="col2"><strong>potential energy</strong> <span class="math inline">\(U(\boldsymbol{q})\)</span></span> is defined as minus the log probability density of the distribution for <span class="math inline">\(\boldsymbol{q}\)</span> that we wish to sample, plus a constant;</p>
</div>
<div class="fragment">
<p>and the <span class="col3"><strong>kinetic energy</strong> <span class="math inline">\(K(\boldsymbol{q})\)</span></span> is given by</p>
<p><span class="math display">\[
\textcolor{var(--tertiary-color)}{K(\boldsymbol{p})} = \boldsymbol{p}'\boldsymbol{M}^{-1}\boldsymbol{p}/2,
\]</span></p>
<p>where <span class="math inline">\(\boldsymbol{M}\)</span> is a symmetric, p.s.d., and often diagonal mass matrix.</p>
</div>
</section>
<section id="hamiltonian-dynamics-1" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Hamiltonian Dynamics</h2>
<p>For <strong>Hamiltonian Monte Carlo</strong>, we usually use the following kind of Hamiltonian functions:</p>
<p><span class="math display">\[
H(\boldsymbol{q},\boldsymbol{p}) = \textcolor{var(--secondary-color)}{U(\boldsymbol{q})} + \textcolor{var(--tertiary-color)}{K(\boldsymbol{p})},
\]</span></p>
<p>Using this specification, the <strong>Hamiltonian functions</strong> can be written as:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\mathrm{d}q_i}{\mathrm{d}t}&amp;=[\boldsymbol{M}^{-1}\boldsymbol{p}]_i,\\
\frac{\mathrm{d}p_i}{\mathrm{d}t}&amp;=-\frac{\partial U}{\partial q_i}.\\
\end{aligned}
\]</span></p>
</section>
<section id="properties" class="slide level2">
<h2>Properties</h2>
<div class="fragment">
<p>Hamiltonian dynamics fulfill a set of <strong>properties</strong> that make them suitable for use in MCMC updating:</p>
<ul>
<li class="fragment"><span class="col1"><strong>Reversibility.</strong></span> The mapping from the state at time <span class="math inline">\(t\)</span> to the state at time <span class="math inline">\(t+s\)</span> is one-to-one and hence has an inverse. This means that Markov chain transitions are reversible.</li>
<li class="fragment"><span class="col1"><strong>Conservation of the Hamiltonian.</strong></span> With dynamics as specified, the Hamiltonian <span class="math inline">\(H\)</span> itself is kept invariant. For Metropolis updates, the acceptance probability is one if <span class="math inline">\(H\)</span> is kept invariant (only approximatively achievable).</li>
<li class="fragment"><span class="col1"><strong>Volume preservation.</strong></span> Hamiltonian dynamics preserves volume in <span class="math inline">\((\boldsymbol{q},\boldsymbol{p})\)</span> space, meaning that we do npt need to account for a change in volume in the acceptance probability for Metropolis updates.</li>
</ul>
</div>
<div class="fragment">
<p><span class="col1"><strong>Reversibility</strong></span> and <span class="col1"><strong>preservation of volume</strong></span> can be maintained even when the Hamiltonian is approximated.</p>
</div>
</section>
<section id="discretization" class="slide level2">
<h2>Discretization</h2>
<div class="fragment">
<p>For implementation, we need to <strong>discretize</strong> the Hamiltonian equations using a small step size <span class="math inline">\(\varepsilon\)</span>: time is then discrete with <span class="math inline">\(t = 0, \varepsilon, 2\varepsilon, 3\varepsilon, \dots\)</span></p>
</div>
<div class="fragment">
<p>The simplest way to approximate the solution is <strong>Euler’s method</strong>:</p>
<div class="quitesmall">
<p><span class="math display">\[
p_i(t+\varepsilon) = p_i(t) - \varepsilon \frac{\partial U}{\partial q_i}(q(t)),\qquad q_i(t+\varepsilon) = q_i(t)+\varepsilon\frac{p_i(t)}{m_i}
\]</span></p>
</div>
</div>
<div class="fragment">
<p>We can obtain better results by slightly <span class="col1"><strong>modifying Euler’s method</strong></span>:</p>
<div class="quitesmall">
<p><span class="math display">\[
p_i(t+\varepsilon) = p_i(t) - \varepsilon \frac{\partial U}{\partial q_i}(q(t)),\qquad q_i(t+\varepsilon) = q_i(t)+\varepsilon\frac{\textcolor{var(--primary-color)}{p_i(t+\varepsilon)}}{m_i}
\]</span></p>
</div>
</div>
<div class="fragment">
<p>For even better results, we can use the <span class="col2"><strong>Leapfrog method</strong></span>:</p>
<div class="quitesmall">
<p><span class="math display">\[
\begin{aligned}
&amp;\textcolor{var(--secondary-color)}{p_i(t+\varepsilon/2)} = p_i(t) - \textcolor{var(--secondary-color)}{(\varepsilon/2)} \frac{\partial U}{\partial q_i}(q(t)),\qquad\qquad q_i(t+\varepsilon) = q_i(t)+\varepsilon\frac{\textcolor{var(--secondary-color)}{p_i(t+\varepsilon/2)}}{m_i},\\
&amp;\textcolor{var(--secondary-color)}{p_i(t+\varepsilon) = p_i(t+\varepsilon/2) - (\varepsilon/2) \frac{\partial U}{\partial q_i}(q(t+e))}
\end{aligned}
\]</span></p>
</div>
</div>
</section>
<section id="discretization-1" class="slide level2 nostretch">
<h2>Discretization</h2>
<div class="columns">
<div class="column fragment centering" style="width:50%;">
<p><img data-src="figures/discrete.png" style="width:100.0%"></p>
</div><div class="column fragment" style="width:50%;">
<div style="height:5em;"></div>
<p>In this example, <span class="math inline">\(H(q,p)=q^2/2+p^2+2\)</span>. The initial state was <span class="math inline">\(q=0,p=1\)</span>. We can see that the leapfrog method preserves volume exactly.</p>
</div></div>
</section>
<section id="hamiltonian-monte-carlo-1" class="slide level2">
<h2>Hamiltonian Monte Carlo</h2>
<div class="fragment">
<p>Using <strong>Hamiltonian dynamics</strong> to sample from a distribution requires translating the density to a <span class="col2"><strong>potential energy</strong></span> function and introducing <span class="col1"><strong>momentum</strong></span> variables. We can use the concept of a canonical distribution from statistical mechanics. Given an energy function <span class="math inline">\(E(x)\)</span> for a state <span class="math inline">\(x\)</span>, the canonical distribution over states has density <span class="math inline">\(P(x)=(1/Z)\mathrm{exp}(-E(x)/T)\)</span>, where <span class="math inline">\(T\)</span> is temperature and <span class="math inline">\(Z\)</span> is a normalizing constant. Using the Hamiltonian <span class="math inline">\(H(\boldsymbol{q},\boldsymbol{p})=U(\boldsymbol{q})+K(\boldsymbol{p})\)</span> as an energy function, we get</p>
<p><span class="math display">\[
P(\boldsymbol{q},\boldsymbol{p}) = \frac{1}{Z}\mathrm{exp}(-U(\boldsymbol{q})/T)\mathrm{exp}(-K(\boldsymbol{p})/T).
\]</span></p>
</div>
<div class="fragment">
<p>We can see that <span class="math inline">\(\boldsymbol{q}\)</span> and <span class="math inline">\(\boldsymbol{p}\)</span> are independent, and both have canonical distributions. The former will be used to represent our variables of interest, and the latter for momentum.</p>
</div>
</section>
<section id="the-two-steps-of-hmc" class="slide level2">
<h2>The Two Steps of HMC</h2>
<div class="fragment">
<p>Each <strong>iteration</strong> has <strong>two steps</strong>:</p>
<ol type="1">
<li class="fragment">In the <span class="col1"><strong>first step</strong></span>, new values for the <strong>momentum variables</strong> are drawn from their Gaussian distribution.</li>
<li class="fragment">In the <span class="col1"><strong>second step</strong></span>, a <strong>Metropolis</strong> update is performed using Hamiltonian dynamics as explained before. We get a proposed new state <span class="math inline">\((\boldsymbol{q}^*,\boldsymbol{p}^*)\)</span>. This state is accepted as the next state of the Markov chain with probability <span class="quitesmall"><span class="math inline">\(\mathrm{min}\Big(1,\quad \mathrm{exp}(-H(\boldsymbol{q}^*,\boldsymbol{p}^*)+H(\boldsymbol{q},\boldsymbol{p}))\Big)\quad =\quad \mathrm{min}\Big(1,\quad \mathrm{exp} \big(-U(\boldsymbol{q}^*)+U(\boldsymbol{q})-K(\boldsymbol{p}^*)+K(\boldsymbol{p})\big)\Big).\)</span></span> If the proposed state is not accepted, the next state is set equal to the current state.</li>
</ol>
</div>
<div class="fragment">
<p>Only in the very first step of the chain does the <strong>probability density</strong> for <span class="math inline">\((\boldsymbol{q},\boldsymbol{p})\)</span> change from one step to the next. Also, the algorithm leaves the canonical distribution invariant.</p>
</div>
</section>
<section id="benefits-of-hmc" class="slide level2">
<h2>Benefits of HMC</h2>
<div class="fragment">
<p>We can use HMC to sample only from <strong>continuous</strong> distributions on <span class="math inline">\(\mathbb{R}^d\)</span> for which the <strong>density</strong> function can be evaluated and the <strong>partial derivatives of its log</strong> can be computed.</p>
</div>
<div class="fragment">
<p>It allows us to <span class="col1"><strong>sample more efficiently</strong></span> from such distributions <strong>than simpler methods</strong> such as random-walk Metropolis.</p>
<div class="centering">
<p><img data-src="figures/benefits.png" class="fragment" style="width:57.0%"></p>
</div>
</div>
</section>
<section id="tuning-hmc" class="slide level2">
<h2>Tuning HMC</h2>
<div class="fragment">
<p>However, in order to actually <strong>attain the benefits</strong> of HMC, we have to <strong>properly tune</strong> the <span class="col2"><strong>step size</strong> <span class="math inline">\(\varepsilon\)</span></span> and the <span class="col4"><strong>trajectory length</strong> <span class="math inline">\(L\)</span></span>, i.e., the number of leapfrog steps. <span class="fragment">Tuning an <span class="col1"><strong>HMC algorithm</strong></span> is also more difficult than tuning a <strong>simple Metropolis</strong> method.</span></p>
<div class="li2">
<ul>
<li class="fragment">If the <span class="col2"><strong>step size</strong> <span class="math inline">\(\varepsilon\)</span></span> is <strong>too large</strong>, acceptance rates will be low.</li>
<li class="fragment">If the <span class="col2"><strong>step size</strong> <span class="math inline">\(\varepsilon\)</span></span> is <strong>too small</strong>, we will waste computation time.</li>
</ul>
</div>
<div class="li4">
<ul>
<li class="fragment">If the <span class="col4"><strong>trajectory length</strong> <span class="math inline">\(L\)</span></span> is <strong>too large</strong>, trajectories may be long and still end up back at the starting point.</li>
<li class="fragment">If the <span class="col4"><strong>trajectory length</strong> <span class="math inline">\(L\)</span></span> is <strong>too small</strong>, it may not reach far enough into unconstrained directions. In connection with a <strong>small</strong> <span class="col2"><strong>step size</strong> <span class="math inline">\(\varepsilon\)</span></span>, it may lead to slow exploration by a random walk.</li>
</ul>
</div>
</div>
</section>
<section id="illustration" class="slide level2 centering">
<h2>Illustration</h2>
<iframe src="mcmc-demo/app.html" width="1280" height="600" data-external="1"></iframe>
</section></section>
<section>
<section id="the-no-u-turn-sampler-nuts" class="title-slide slide level1 center">
<h1></h1>
<div style="position:relative;width:1280px;height:720px;background-color:var(--primary-color);
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            text-align:center;top:-12px;">
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#intro-and-recap" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Intro and Recap</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#hamiltonian-monte-carlo" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Hamiltonian Monte Carlo</a></p><span class="menu-title" style="display: none">The No-U-Turn-Sampler (NUTS)</span><h1 style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;color:#fff;margin:25px 0;font-weight:800;">The No-U-Turn-Sampler (NUTS)</h1><p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#our-implementation" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Our Implementation</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;">&nbsp;</p></div>
</section>
<section id="why-nuts" class="slide level2">
<h2>Why NUTS?</h2>
</section>
<section id="setting-l" class="slide level2">
<h2>Setting L</h2>
</section>
<section id="eliminating-the-need-to-set-l" class="slide level2">
<h2>Eliminating the Need to Set L</h2>
</section>
<section id="nuts" class="slide level2">
<h2>NUTS</h2>
</section>
<section id="adaptively-tuning-ε" class="slide level2">
<h2>Adaptively Tuning ε</h2>
</section>
<section id="dual-averaging-nuts" class="slide level2">
<h2>Dual-Averaging NUTS</h2>
</section>
<section id="illustration-1" class="slide level2 centering">
<h2>Illustration</h2>
<iframe src="mcmc-demo/app.html" width="1280" height="600" data-external="1"></iframe>
</section></section>
<section>
<section id="our-implementation" class="title-slide slide level1 center">
<h1></h1>
<div style="position:relative;width:1280px;height:720px;background-color:var(--primary-color);
            display:flex;flex-direction:column;align-items:center;justify-content:center;
            text-align:center;top:-12px;">
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;"><a href="#intro-and-recap" style="text-decoration:none;color:var(--primary-color-semilight, #ffffff) !important;font-weight:800;">Intro and Recap</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#hamiltonian-monte-carlo" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">Hamiltonian Monte Carlo</a></p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;"><a href="#the-no-u-turn-sampler-nuts" style="text-decoration:none;color:var(--primary-color-lightened, #ffffff) !important;font-weight:800;">The No-U-Turn-Sampler (NUTS)</a></p><span class="menu-title" style="display: none">Our Implementation</span><h1 style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;color:#fff;margin:25px 0;font-weight:800;">Our Implementation</h1><p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.5em;margin:5px 0;font-weight:800;">&nbsp;</p>
<p style="font-family:'Red Hat Display','Inter',Helvetica,sans-serif;font-size:1.2em;margin:5px 0;font-weight:800;">&nbsp;</p></div>
</section>
<section id="slide" class="slide level2">
<h2>Slide</h2>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div class="centering titlebox1">
<p><em>This list is <strong>scrollable</strong>.</em></p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-hoffman2014" class="csl-entry" role="listitem">
Hoffman, M. D., Gelman, A., et al. (2014). The no-u-turn sampler: Adaptively setting path lengths in hamiltonian monte carlo. <em>J. Mach. Learn. Res.</em>, <em>15</em>(1), 1593–1623.
</div>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="compstats_project_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="compstats_project_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="compstats_project_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="compstats_project_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'pdfMaxPagesPerSlide': 1,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: false,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: false,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1280,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 0,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>